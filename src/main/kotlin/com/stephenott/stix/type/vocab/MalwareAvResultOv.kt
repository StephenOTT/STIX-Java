package com.stephenott.stix.type.vocab

class MalwareAvResults(private val results: LinkedHashSet<MalwareAvResult> = linkedSetOf()) :
    Set<MalwareAvResult> by results {
}

class MalwareAvResult(private val result: String) : OpenVocab {
    override fun getValue(): String {
        return result
    }

    companion object {
        const val vocabName = "malware-av-result-ov"

        var vocab: LinkedHashSet<String> = linkedSetOf(
            "malicious", "suspicious", "benign",
            "unknown"
        )
            set(value) {
                require(value.isNotEmpty())
                field = value
            }
    }

    init {
        require(this.result in vocab)
    }
}